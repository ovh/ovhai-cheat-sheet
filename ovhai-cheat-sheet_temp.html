<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<link href="templates/cheat-sheet/template/assets/style.css" rel="stylesheet">
</head>
<body>
<header>
  <h1><img width="150" src="templates/cheat-sheet/template/assets/logo-w.png"/> ovhai CLI Cheat Sheet</h1>
</header>
<section class="content">
<div class="sect1">
<h2 id="_about_ovhai_cli">About ovhai CLI</h2>
<div class="sectionbody">
<p class=""><code>ovhai</code> is a CLI that allows you to interact with OVHcloud AI Training (<a href="https://www.ovhcloud.com/fr/public-cloud/ai-training/" class="bare">https://www.ovhcloud.com/fr/public-cloud/ai-training/</a>
).
OVHcloud AI training is a cloud service that allows Data Scientists, ML Engineers and Deep Learning practitioners to create and allocate training ressources on demand.</p>
<p class="">With the CLI you can:
* manage jobs (list, run, stop, execute commands inside&#8230;&#8203;)
* manage AI notebooks (start, stop, sync&#8230;&#8203;)
* manage object storage (upload data to object storage, attach data to a notebook, delete a bucket/container &#8230;&#8203;)
* manage apps (list, run, delete&#8230;&#8203;)
* manage containers registries (list, add a private registry&#8230;&#8203;)
* manage access tokens
* &#8230;&#8203;</p>
</div>
</div>
<div class="sect1">
<h2 id="_installation">Installation</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_install_through_curl">Install through curl</h3>
<p class="">Define the region and then download the binary according to your OS:</p>
<div class="literalblock">
<div class="content">
<pre>$ export REGION=gra ; curl -O https://cli.$REGION.training.ai.cloud.ovh.net/ovhai-darwin.zip
$ unzip ovhai-darwin.zip
$ sudo mv ovhai /usr/local/bin/ovhai
$ rm ovhai-darwin.zip</pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_prerequisites">Prerequisites</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_create_an_openstack_user">Create an OpenStack user</h3>
<p class="">Create an OpenStack User with the roles "AI Training Operator" and "ObjectStore operator".
Follow the guide: <a href="https://docs.ovh.com/gb/en/ai-training/create-user/" class="bare">https://docs.ovh.com/gb/en/ai-training/create-user/</a></p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_usage">Usage</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_show_version">Show version</h3>
<div class="literalblock">
<div class="content">
<pre>$ ovhai --version

ovhai 2.3.1</pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_login">Login</h3>
<p class=""><code>$ ovhai login</code></p>
<p class="">Itâ€™s the first command you need to execute. To login into AI Training platform you need the credentials of a user with the roles "AI Training Operator" and ObjectStore operator.
Enter the user name and password.</p>
</div>
<div class="sect2">
<h3 id="_show_current_user_information">Show current user information</h3>
<div class="literalblock">
<div class="content">
<pre>$ ovhai me

Name:     user-NnnmWdWTFjn3
Tenant:   a123a4e56b789c1ba23a456b789fcf01
Trust Id: bea1c2cc345e67a89adf1023c45ccd67</pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_show_all_the_regions_and_environments">Show all the regions and environments</h3>
<div class="literalblock">
<div class="content">
<pre>$ ovhai config ls

NAME URL
BHS  https://bhs.training.ai.cloud.ovh.net/v1
GRA  https://gra.training.ai.cloud.ovh.net/v1</pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_jobs">Jobs</h2>
<div class="sectionbody">
<p class="">A job is a Docker container running on the OVHcloud AI infrastructure.
You can specify a Docker image (from Docker Hub or a private registry), allocate the request hardware requirements (number of GPUs, number of CPUs), link the data in input and output to an Object Storage through volumes, and run it.</p>
<p class="">A job have a start and an end.</p>
<div class="sect2">
<h3 id="_list_jobs">List jobs</h3>
<p class=""><code>$ ovhai job ls</code></p>
</div>
<div class="sect2">
<h3 id="_run_a_simple_job">Run a simple job</h3>
<p class=""><code>$ ovhai job run ubuntu&#8201;&#8212;&#8201;bash -c "while true; do echo toto; sleep 2; done"</code></p>
</div>
<div class="sect2">
<h3 id="_run_a_job_and_pass_your_ssh_key">Run a job and pass your SSH key</h3>
<p class=""><code>$ ovhai job run ubuntu -s $HOME/.ssh/id_rsa.pub&#8201;&#8212;&#8201;bash -c "sleep infinity"</code></p>
</div>
<div class="sect2">
<h3 id="_run_a_job_with_1_cpu">Run a job, with 1 CPU</h3>
<p class=""><code>$ ovhai job run &lt;docker_image&gt; --cpu 1&#8201;&#8212;&#8201;sleep infinity</code></p>
<p class="">-c, --cpu: number of CPUs (ignored if GPUs is specified)</p>
</div>
<div class="sect2">
<h3 id="_run_a_job_with_2_gpus_and_plug_it_to_an_object_storage_container_bucket_in_read_only_access_mode">Run a job, with 2 GPUs and plug it to an object storage container (bucket) in read only access mode</h3>
<p class=""><code>$ ovhai job run &lt;docker_image&gt; --gpu 2 -v &lt;container_name&gt;@&lt;REGION&gt;:/data:ro&#8201;&#8212;&#8201;sleep infinity</code></p>
<p class="">-g, --gpu: number of GPUs (default 1)</p>
</div>
<div class="sect2">
<h3 id="_get_job_status">Get job status</h3>
<p class=""><code>$ ovhai job get &lt;job_ID&gt;</code></p>
</div>
<div class="sect2">
<h3 id="_diplay_job_logs">Diplay job logs</h3>
<p class=""><code>$ ovhai job logs &lt;job_ID&gt;</code></p>
</div>
<div class="sect2">
<h3 id="_diplay_job_logs_and_stream_the_logs">Diplay job logs and stream the logs</h3>
<p class=""><code>$ ovhai job logs -f &lt;job_ID&gt;</code></p>
</div>
<div class="sect2">
<h3 id="_execute_commands_in_a_job">Execute commands in a job</h3>
<p class=""><code>$ ovhai job exec -it &lt;job_ID&gt;&#8201;&#8212;&#8201;bash</code></p>
</div>
<div class="sect2">
<h3 id="_synchronize_manually_push_data_from_job_to_object_storage_while_it_is_running">Synchronize - Manually push data from Job to Object Storage (while it is running)</h3>
<p class=""><code>$ ovhai job push-data &lt;job_ID&gt;</code></p>
</div>
<div class="sect2">
<h3 id="_synchronize_manually_pull_data_from_object_storage_to_job_while_it_is_running">Synchronize - Manually pull data from Object Storage to Job (while it is running)</h3>
<p class=""><code>$ ovhai job pull-data &lt;job_ID&gt;</code></p>
</div>
<div class="sect2">
<h3 id="_stop_a_job">Stop a job</h3>
<p class=""><code>$ ovhai job stop &lt;job_ID&gt;</code></p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_data_object_storage">Data (Object Storage)</h2>
<div class="sectionbody">
<p class="">Jobs are containers so by default there are ephemeral, it means that if you store data inside jobs, you can lose them.
The solution is to link your jobs and notebooks to Object Storage containers (buckets).</p>
<div class="sect2">
<h3 id="_list_object_storage_containers">List Object Storage containers</h3>
<p class=""><code>$ ovhai data ls &lt;REGION&gt;</code></p>
</div>
<div class="sect2">
<h3 id="_list_object_storage_containers_that_starting_with_test">List Object Storage containers that starting with "test%"</h3>
<p class=""><code>$ ovhai data ls &lt;REGION&gt; --prefix test</code></p>
</div>
<div class="sect2">
<h3 id="_push_files_objects_to_my_container">Push files (objects) to my-container</h3>
<p class=""><code>$ ovhai data upload &lt;REGION&gt; my-container some/local-file other-file</code></p>
</div>
<div class="sect2">
<h3 id="_delete_an_object_on_my_container">Delete an object on my-container</h3>
<p class=""><code>$ ovhai data delete &lt;REGION&gt; my-container my-object</code></p>
</div>
<div class="sect2">
<h3 id="_delete_my_container">Delete my-container</h3>
<p class=""><code>$ ovhai data delete &lt;REGION&gt; my-container</code></p>
</div>
<div class="sect2">
<h3 id="_delete_all_of_your_containers_starting_by_test">Delete all of your containers starting by "test%"</h3>
<p class=""><code>$ ovhai data delete &lt;REGION&gt; --prefix test</code></p>
</div>
<div class="sect2">
<h3 id="_delete_all_of_your_containers">Delete all of your containers</h3>
<p class=""><code>$ ovhai data delete &lt;REGION&gt; --all</code></p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_apps">Apps</h2>
<div class="sectionbody">
<p class="">An app is like a job but for API or daemon process that should never stop.
An app runs as a group of load balanced Docker containers within OVHcloud AI infrastructure.</p>
<p class="">You can specify a Docker image (from Docker Hub or a private registry), allocate the request hardware requirements (number of GPUs, number of CPUs), link the data in input and output to an Object Storage through volumes, and run it.</p>
<div class="sect2">
<h3 id="_list_apps">List apps</h3>
<p class=""><code>$ ovhai app ls</code></p>
</div>
<div class="sect2">
<h3 id="_run_an_app_and_specify_we_want_3_replicas">Run an app and specify we want 3 replicas</h3>
<p class=""><code>$ ovhai app run priv-registry.gra.training.ai.cloud.ovh.net/public/infrastructureascode/hello-world:latest -p 8080 --cpu 1 --fixed-scale 3</code></p>
</div>
<div class="sect2">
<h3 id="_run_an_app_and_mount_a_volume_linked_to_an_object_storage_container">Run an app and mount a volume linked to an Object Storage container</h3>
<p class=""><code>$ ovhai app run &lt;docker-image&gt; --gpu 4 --volume my-container@&lt;REGION&gt;:/data</code></p>
</div>
<div class="sect2">
<h3 id="_get_app_status">Get app status</h3>
<p class=""><code>$ ovhai app get &lt;app_ID&gt;</code></p>
</div>
<div class="sect2">
<h3 id="_get_app_s_url">Get app&#8217;s URL</h3>
<p class=""><code>$ ovhai app get &lt;app_ID&gt; -o json | jq ".status.url"</code></p>
</div>
<div class="sect2">
<h3 id="_stop_an_app">Stop an app</h3>
<p class=""><code>$ ovhai app stop &lt;app_ID&gt;</code></p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_notebooks">Notebooks</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_xxx">xxx</h3>
<p class="">xxx</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_registries">Registries</h2>
<div class="sectionbody">
<p class="">A registry is a place where you can push and pull your Docker images.
By default, you have access to a shared registry scoped to your project, you can only push images and use them for jobs.
You can also add private registries.</p>
<div class="sect2">
<h3 id="_list_registries">List registries</h3>
<p class=""><code>$ ovhai registry ls</code></p>
</div>
<div class="sect2">
<h3 id="_add_a_private_registry">Add a private registry</h3>
<p class=""><code>$ ovhai registry add &lt;url&gt;</code></p>
</div>
<div class="sect2">
<h3 id="_get_registry_information">Get registry information</h3>
<p class=""><code>$ ovhai registry get &lt;registry_ID&gt;</code></p>
</div>
<div class="sect2">
<h3 id="_delete_a_private_registry">Delete a private registry</h3>
<p class=""><code>$ ovhai registry delete &lt;registry_ID&gt;</code></p>
</div>
</div>
</div>
<div class="sect1 authors">
<h3>Authors :</h3>
<div class="author">
<div class="author-avatar"><img src="https://pbs.twimg.com/profile_images/726148230224949249/g2T2qehD_400x400.jpg"/></div>
<div class="author-name"><a href="https://twitter.com/aurelievache">@aurelievache</a></div>
<div class="author-bio">DevRel at OVHcloud</div>
</div>

<div class="author-bio">v1.0.0</div>
</div>
</section>
</body>